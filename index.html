
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Genji Store</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{margin:0;font-family:system-ui;background:#f4f6f9}
header{background:#0f2027;color:#fff;padding:12px}
.products{padding:12px;display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.product{background:#fff;border-radius:14px;overflow:hidden;cursor:pointer}
.product img{width:100%;aspect-ratio:1/1;object-fit:cover}
.product-body{padding:8px}
.price{color:#c1121f;font-weight:700}
#productModal{position:fixed;inset:0;background:rgba(0,0,0,.85);display:none;justify-content:center;align-items:center}
.box{background:#fff;width:92%;max-width:420px;border-radius:18px;overflow:hidden}
.slider{overflow-x:auto;white-space:nowrap}
.slider img{width:100%;display:inline-block}
.content{padding:14px}
button{width:100%;padding:12px;border:none;border-radius:14px;margin-top:8px;font-weight:700}
.whatsapp{background:#25D366;color:#fff}
.close{background:#eee}
</style>
</head>

<body>

<header>
<h2>ðŸ›’ Genji Store</h2>
</header>

<div class="products" id="productList"></div>

<div id="productModal">
<div class="box">

<div class="slider" id="pmSlider"></div>

<div class="content">
<h3 id="pmName"></h3>
<div id="pmPrice" class="price"></div>
<p id="pmLocation"></p>

<button class="whatsapp" id="pmWhatsApp">
ðŸ’¬ Chat on WhatsApp
</button>

<button class="close" onclick="closeProduct()">Close</button>
</div>

</div>
</div>

<script>
firebase.initializeApp({
apiKey:"AIzaSyCk8AopowtdPEZeYXsnEiT1o85kngAgG0Y",
authDomain:"genji-store.firebaseapp.com",
projectId:"genji-store"
});

const auth=firebase.auth();
const db=firebase.firestore();

auth.onAuthStateChanged(user=>{
if(!user){location.replace("login.html");return;}
loadProducts();
});

function loadProducts(){
db.collection("products")
.where("status","==","available")
.onSnapshot(snap=>{
productList.innerHTML="";
snap.forEach(doc=>{
const p=doc.data();
productList.innerHTML+=`
<div class="product" onclick='openProduct(${JSON.stringify(p)})'>
<img src="${p.images?.[0] || ''}">
<div class="product-body">
<h4>${p.name}</h4>
<div class="price">â‚¹${p.price}</div>
</div>
</div>`;
});
});
}

function openProduct(p){

pmName.innerText=p.name;
pmPrice.innerText="â‚¹"+p.price;
pmLocation.innerText=`ðŸ“ ${p.village}, ${p.district}, ${p.state}`;

pmSlider.innerHTML="";
(p.images || []).forEach(url=>{
pmSlider.innerHTML+=`<img src="${url}">`;
});

pmWhatsApp.onclick=()=>openWhatsApp(p.contact,p.name);

productModal.style.display="flex";
}

function closeProduct(){
productModal.style.display="none";
}

function openWhatsApp(num,name){
const msg=encodeURIComponent(`Hi, I am interested in your ${name}.`);
window.open(`https://wa.me/91${num}?text=${msg}`,"_blank");
}
</script>

</body>
</html>
