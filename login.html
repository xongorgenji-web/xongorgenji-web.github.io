<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Login ‚Äì Reselling & Buying Products</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f1f3f6;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

.container{
  width:100%;
  max-width:380px;
  padding:20px;
}

.brand{
  text-align:center;
  margin-bottom:20px;
}

/* üåÄ GENJIXONGOR LOGO */
.brand .logo{
  font-size:12px;
  letter-spacing:2px;
  font-weight:bold;
  color:#ff9900;
  margin-bottom:6px;
  display:block;
}

.brand h1{
  margin:0;
  font-size:26px;
  color:#131921;
}

.brand p{
  margin-top:8px;
  font-size:14px;
  color:#555;
}

.login-box{
  background:#fff;
  padding:25px;
  border-radius:8px;
  box-shadow:0 2px 10px rgba(0,0,0,0.15);
}

.role-select{
  display:flex;
  gap:10px;
  margin-bottom:15px;
}

.role-select button{
  flex:1;
  padding:10px;
  font-weight:bold;
  border:2px solid #ccc;
  background:#f8f8f8;
  cursor:pointer;
  border-radius:6px;
}

.role-select button.active{
  border-color:#ff9900;
  background:#ffe0b2;
}

input{
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:5px;
  border:1px solid #ccc;
  font-size:15px;
}

button.main{
  width:100%;
  margin-top:15px;
  padding:12px;
  background:#ffd814;
  border:1px solid #fcd200;
  font-weight:bold;
  cursor:pointer;
  font-size:16px;
}

button.secondary{
  width:100%;
  margin-top:10px;
  padding:12px;
  background:#ff9900;
  border:none;
  font-weight:bold;
  cursor:pointer;
  font-size:16px;
}

.terms{
  margin-top:12px;
  font-size:13px;
  display:flex;
  gap:6px;
  align-items:flex-start;
}

.terms a{
  color:#007185;
  cursor:pointer;
  text-decoration:underline;
}

.message{
  margin-top:12px;
  padding:10px;
  border-radius:5px;
  font-size:14px;
  display:none;
}

.success{ background:#d4edda; color:#155724; }
.error{ background:#f8d7da; color:#721c24; }

/* TERMS MODAL */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.6);
  display:none;
  justify-content:center;
  align-items:center;
}
.modal-content{
  background:#fff;
  max-width:420px;
  max-height:80vh;
  overflow:auto;
  padding:20px;
  border-radius:8px;
}
.modal-content h3{margin-top:0}
.modal-content button{
  margin-top:10px;
  width:100%;
  padding:10px;
  background:#ff9900;
  border:none;
  font-weight:bold;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="container">

  <!-- BRAND -->
  <div class="brand">
    <span class="logo">üåÄ GENJIXONGOR</span>
    <h1>üîÅ Reselling & Buying Products</h1>
    <p>Select role before login or register</p>
  </div>

  <!-- LOGIN BOX -->
  <div class="login-box">

    <!-- ROLE -->
    <div class="role-select">
      <button id="buyerBtn" onclick="selectRole('buyer')">üõçÔ∏è Buyer</button>
      <button id="sellerBtn" onclick="selectRole('seller')">üì¶ Seller</button>
    </div>

    <!-- INPUTS -->
    <input id="email" type="email" placeholder="Email">
    <input id="password" type="password" placeholder="Password">

    <!-- TERMS -->
    <div class="terms">
      <input type="checkbox" id="agree">
      <span>
        I agree to the
        <a onclick="openTerms()">Terms & Conditions</a>
      </span>
    </div>

    <!-- MESSAGE -->
    <div id="msg" class="message"></div>

    <!-- BUTTONS -->
    <button class="main" onclick="login()">Login</button>
    <button class="secondary" onclick="register()">Register</button>

  </div>

</div>

<!-- TERMS MODAL -->
<div class="modal" id="termsModal">
  <div class="modal-content">
    <h3>Terms & Conditions</h3>
    <p>
      ‚Ä¢ This platform is a marketplace for reselling and buying products.<br><br>
      ‚Ä¢ Sellers are responsible for product accuracy, images, and pricing.<br><br>
      ‚Ä¢ Buyers must verify product details before purchasing.<br><br>
      ‚Ä¢ The platform is not responsible for disputes between buyers and sellers.<br><br>
      ‚Ä¢ Any misuse, fraud, or illegal activity will result in account termination.<br><br>
      ‚Ä¢ By using this app, you agree to these terms.
    </p>
    <button onclick="closeTerms()">Close</button>
  </div>
</div>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyCk8AopowtdPEZeYXsnEiT1o85kngAgG0Y",
  authDomain:"genji-store.firebaseapp.com",
  projectId:"genji-store"
});

const auth=firebase.auth();
const db=firebase.firestore();

let selectedRole=null;

/* ROLE */
function selectRole(role){
  selectedRole=role;
  buyerBtn.classList.remove("active");
  sellerBtn.classList.remove("active");
  if(role==="buyer") buyerBtn.classList.add("active");
  if(role==="seller") sellerBtn.classList.add("active");
}

/* MESSAGE */
function showMessage(text,type){
  msg.innerText=text;
  msg.className="message "+type;
  msg.style.display="block";
}

/* TERMS */
function openTerms(){ termsModal.style.display="flex"; }
function closeTerms(){ termsModal.style.display="none"; }

/* VALIDATION */
function validate(){
  if(!selectedRole){ showMessage("Select Buyer or Seller","error"); return false; }
  if(!agree.checked){ showMessage("You must accept Terms & Conditions","error"); return false; }
  if(!email.value || !password.value){ showMessage("Enter email & password","error"); return false; }
  return true;
}

/* REGISTER */
function register(){
  if(!validate()) return;

  auth.createUserWithEmailAndPassword(email.value,password.value)
    .then(async cred=>{
      await db.collection("users").doc(cred.user.uid).set({
        role:selectedRole,
        createdAt:firebase.firestore.FieldValue.serverTimestamp()
      });
      showMessage("Account created successfully","success");
      setTimeout(()=>location.replace(selectedRole==="seller"?"seller.html":"index.html"),1200);
    })
    .catch(e=>showMessage(e.message,"error"));
}

/* LOGIN */
function login(){
  if(!validate()) return;

  auth.signInWithEmailAndPassword(email.value,password.value)
    .then(async cred=>{
      const doc=await db.collection("users").doc(cred.user.uid).get();
      if(!doc.exists || doc.data().role!==selectedRole){
        showMessage("Role mismatch","error");
        auth.signOut();
        return;
      }
      showMessage("Login successful","success");
      setTimeout(()=>location.replace(selectedRole==="seller"?"seller.html":"index.html"),1000);
    })
    .catch(e=>showMessage(e.message,"error"));
}

/* STOP AUTO LOGIN LOOP */
auth.onAuthStateChanged(()=>{});
</script>

</body>
</html>