<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Seller Dashboard - Genji Store</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

<style>
body{margin:0;font-family:system-ui;background:#f4f6f9}
header{background:#0f2027;color:#fff;padding:14px;display:flex;justify-content:space-between}
.container{padding:16px;max-width:900px;margin:auto}
.card{background:#fff;padding:20px;border-radius:16px;margin-bottom:20px}
input,select{width:100%;padding:12px;margin-top:10px;border-radius:10px;border:1px solid #ddd}
button{width:100%;padding:12px;margin-top:10px;border:none;border-radius:12px;font-weight:bold;cursor:pointer;background:#ff9900;color:#fff}
.products{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:12px}
.product{background:#fff;border-radius:14px;overflow:hidden}
.product img{width:100%;height:180px;object-fit:cover}
.product-body{padding:10px}
</style>
</head>

<body>

<header>
<h2>ðŸ“¦ Seller Dashboard</h2>
<button onclick="logout()">Logout</button>
</header>

<div class="container">

<div class="card">
<h3>Add Product</h3>

<input id="pname" placeholder="Product name">
<input id="pprice" type="number" placeholder="Price â‚¹">

<select id="pcategory">
<option value="">Category</option>
<option>Phones</option>
<option>Clothes</option>
<option>Electronics</option>
<option>Furniture</option>
<option>Bike</option>
<option>Car</option>
</select>

<h4>Product Images (URL)</h4>
<input id="img1" placeholder="Front image URL (required)">
<input id="img2" placeholder="Image 2 URL (optional)">
<input id="img3" placeholder="Image 3 URL (optional)">

<input id="pcontact" placeholder="WhatsApp number">
<input id="pvillage" placeholder="Village">
<input id="pdistrict" placeholder="District">
<input id="pstate" placeholder="State" value="Meghalaya">

<button onclick="saveProduct()">Save Product</button>
</div>

<div class="card">
<h3>My Products</h3>
<div class="products" id="myProducts">Loading...</div>
</div>

</div>

<script>
firebase.initializeApp({
apiKey:"AIzaSyCk8AopowtdPEZeYXsnEiT1o85kngAgG0Y",
authDomain:"genji-store.firebaseapp.com",
projectId:"genji-store"
});

const auth=firebase.auth();
const db=firebase.firestore();
let uid=null;

auth.onAuthStateChanged(user=>{
if(!user){location.href="login.html";return;}
uid=user.uid;
loadProducts();
});

async function saveProduct(){

const imgFront = img1.value.trim();
if(!imgFront){ alert("Front image required"); return; }

const images = [
img1.value.trim(),
img2.value.trim(),
img3.value.trim()
].filter(u=>u);

await db.collection("products").add({
name:pname.value,
price:Number(pprice.value),
category:pcategory.value,
images:images,
contact:pcontact.value,
village:pvillage.value,
district:pdistrict.value,
state:pstate.value,
sellerId:uid,
status:"available",
createdAt:firebase.firestore.FieldValue.serverTimestamp()
});

alert("Product saved!");
location.reload();
}

function loadProducts(){
db.collection("products")
.where("sellerId","==",uid)
.onSnapshot(snap=>{
myProducts.innerHTML="";
snap.forEach(doc=>{
const p=doc.data();
myProducts.innerHTML+=`
<div class="product">
<img src="${p.images?.[0] || ''}">
<div class="product-body">
<h4>${p.name}</h4>
<b>â‚¹${p.price}</b>
</div>
</div>`;
});
});
}

function logout(){
auth.signOut().then(()=>location.href="login.html");
}
</script>

</body>
</html>
